/**
 *
 * All styles pertaining to the navbar
 *
 */

$fwidth: $radiusScale * 0.5em;
$fheight: $radiusScale * 2em;
$ffinalHeight: $fheight;

@keyframes anim_linkhover{
	0%, 100% { 
		color: darken($icon-Weidler-color, 30%);
		text-shadow: none;
	}
	50% {
		color: transparent;
		text-shadow: 0px 0px 3px rgba(0, 0, 0, 0.66);
	}
}

.alogo-wrapper{
	// testingonly
	// visibility: hidden;

	$wrapper-index: 1;
	z-index: $wrapper-index;
	position: relative;
	margin-left: 1.65em;
	margin-top: 0.25em;
	padding: 0;
	top: 0;
	left: 0;
	white-space: nowrap;

	width: $icon-Weidler-size;
	height: $icon-Weidler-size;
	transform: rotate(-75deg);
	transition: transform $flagAnimSpeed $flagAnimCurve;

	&:after{
		content: '';
		width: 75px;
		height: 75px;
		left:-50%;
		top:-50%;
		opacity: 0.85;
		background: white;
		position: absolute;
	}

	.alens-hood{
		$hoodWidth: $fwidth;
		$hoodScale: $radiusScale + $fheight;
		$center: ($hoodScale - $icon-Weidler-size) * -0.5; 

		position: relative;
		z-index: length($icon-aperture-colors) + 2; // buffer and extra in case
		width: $hoodScale - $hoodWidth;
		height: $hoodScale - $hoodWidth;
		opacity: 1.0;
		border-radius: 50%;
		border: $hoodWidth / 2 solid $icon-Weidler-color * 0.2;
		top: $center + $hoodWidth/2;
		left: $center + $hoodWidth/2;
		box-sizing: border-box;
	}


	.aflag{
		$fheight: $fheight * 6 / length($icon-aperture-colors) * ($flagScale + 2) / 2.5;
		$ffinalHeight: $ffinalHeight * 6 / length($icon-aperture-colors) * ($finalFlagScale + 2) / 2.5;
		background: rgba(0,0,0,1);
		opacity: 1.0;
		height: $fheight;
		width: $fwidth * $flagScale;
		border-left: 1px solid rgba(1,1,1,0.50);
		box-shadow: 0 0 0.5em * $radiusScale / 8 0 rgba(0,0,0,0.75);
		box-sizing: border-box;
		position: absolute;
		border-top-right-radius: 50%;
		border-bottom-right-radius: 50%;
		top: calc(50% - #{$fheight / 2});
		left: calc(50% - #{$fwidth * $flagScale / 2});

		transition: width $flagAnimSpeed $flagAnimCurve, 
					height $flagAnimSpeed $flagAnimCurve, 
					top $flagAnimSpeed $flagAnimCurve, 
					left $flagAnimSpeed $flagAnimCurve, 
					transform $flagAnimSpeed $flagAnimCurve,
					background $flagAnimSpeed $flagAnimCurve;
	}

	@each $aperture-color in $icon-aperture-colors{
		$i: index($icon-aperture-colors, $aperture-color);
		.aflag-#{$i}{
			z-index: #{$wrapper-index + $i};
			background: $icon-Weidler-color * 1.2;

			// transform our 'aperture flags' around a circle
			$degrees: ($i - 1) * (360 / length($icon-aperture-colors));
			$flagdiff: $fwidth * $flagScale / 2em;
			$point: parametric(0, 0, $radiusScale - $flagdiff, $degrees * 1deg);
			transform: translate(#{map-get($point, x)}em, #{map-get($point, y)}em) rotate(#{$degrees}deg);
		}
	}

}


.navbar-brand{
	padding: 0;
	margin-left: 1em !important;
	width: $icon-Weidler-size;
	height: $icon-Weidler-size;

	&:hover > .icon-Weidler_Icon, &:focus > .icon-Weidler_Icon{
		color: $icon-Weidler-hover;
		text-shadow: 0 0 8px rgba(0,0,0,1.0);
	}

	&:hover + .alogo-wrapper, &:focus + .alogo-wrapper{
		transform: rotate(-65deg);
	}

	&:hover + .alogo-wrapper .aflag, &:focus + .alogo-wrapper .aflag{
		width: $fwidth * $finalFlagScale;
		height: $ffinalHeight;

		top: calc(50% - #{$ffinalHeight / 2});
		left: calc(50% - #{$fwidth * $finalFlagScale / 2});
	}

	@each $aperture-color in $icon-aperture-colors{
		$i: index($icon-aperture-colors, $aperture-color);
		&:hover + .alogo-wrapper .aflag-#{$i}, &:focus + .alogo-wrapper .aflag-#{$i}{
			background: lighten($aperture-color, 12%);

			// transform our 'aperture flags' around a circle
			$degrees: ($i - 1) * (360 / length($icon-aperture-colors));
			$flagdiff: $fwidth * $finalFlagScale / 2em;
			$point: parametric(0, 0, $radiusScale - $flagdiff, $degrees * 1deg);
			transform: translate(#{map-get($point, x)}em, #{map-get($point, y)}em) rotate(#{$degrees}deg);
		}
	}

	.icon-Weidler_Icon {
		//testingonly
		// visibility: hidden;

		font-size: $icon-Weidler-size;
		color: $icon-Weidler-color;
		text-shadow: none;
		display: block;
		transition: text-shadow $icon-Weidler-transition, color $icon-Weidler-transition;
		position: relative;
		z-index: 2;

		&:before {
			content: $icon-Weidler_Icon;
		}
	}
}

.navbar{

	&:after{
		$size: 0.2em;

		$gradient: 'linear-gradient(to right';
		@each $aperture-color in $icon-aperture-colors{
			$i: index($icon-aperture-colors, $aperture-color);
			$percent: "#{($i - 1) / length($icon-aperture-colors) * 100}%";
			$thiscolor: "#{$aperture-color} #{$percent}";
			$gradient: "#{$gradient}, #{$thiscolor}";
		}
		$gradient: "#{$gradient});";

		content: '';
		width: 100%;
		position: absolute;
		left:0;
		bottom: 0;
		height: $size;
		background: #333;
		background: #{$gradient};
	}
}

.navbar{
	$navbarBackground: #fbfbfb;
	background: $navbarBackground;

	li{
		font-family: 'Cairo', sans-serif;
		font-size: 12pt;
		color: black;

		a{
			color: darken($icon-Weidler-color, 30%);
			padding-top: 11px;
			padding-bottom: 11px;
			border: 2px solid $navbarBackground;
		}

		&:hover a{
			animation: anim_linkhover $linkSpeed ease-in-out;
			border-color: darken($icon-Weidler-color, 30%);
			box-shadow: inset 0px 0px 15px 3px rgba(0,0,0,0.4);
			background: none;
		}

		&.active a{
			background: green;
		}
	}

	#aw_navbar{
		margin-left: (4.5 + $radiusScale) * 1em;
	}
}
